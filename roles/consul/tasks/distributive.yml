---
- name: install distributive
  sudo: yes
  yum:
    name: "https://bintray.com/artifact/download/ciscocloud/rpm/distributive-0.0.1-1.x86_64.rpm"
    state: present
  tags:
    - consul
  notify:
    - reload consul

- name: register distributive tests with consul
  sudo: yes
  copy:
    src: distributive-service-consul.json
    dest: /etc/consul
  notify:
    - reload consul
  tags:
    - consul

- name: copy distributive consul test
  sudo: yes
  copy:
    src: distributive-checklist-consul.json
    dest: /usr/share/distributive/consul.json

- name: run distributive consul test
  sudo: yes
  command: /usr/bin/distributive -f /usr/share/distributive/consul.json
  tags:
    - consul
